package com.haiyisec;

import ch.qos.logback.classic.Level;
import ch.qos.logback.classic.LoggerContext;
import org.slf4j.LoggerFactory;
import org.zen.frame._init.scan.FileScan;
import org.zen.frame.func.encrypt.custom.HySecurityUtil;
import org.zen.frame.global.ErrorConfig;
import org.zen.frame.global.Global;
import org.zen.frame.vendor.lic.LicenseWriteUtil;

import java.util.Arrays;

public class ApplicationArgsDeal {


    //    private static String scanDataStr = "{\"org.zen.frame.base.domain.annotation.dic.Zen_Dic_DD\":[{\"classPath\":\"org.zen.modules.sysmngr.domain.service.sysrole.ZenSysRoleService\",\"element\":\"getDic_DD_Role\",\"paramTypes\":[\"java.util.Map\"]},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.service.dicservice.InventoryDicService\",\"element\":\"getDic_DD_in_commodity\",\"paramTypes\":[\"java.util.Map\"]},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.service.dicservice.InventoryDicService\",\"element\":\"getDic_DD_applicant\",\"paramTypes\":[\"java.util.Map\"]},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.service.dicservice.InventoryDicService\",\"element\":\"getDic_DD_commodity\",\"paramTypes\":[\"java.util.Map\"]},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.service.dicservice.InventoryDicService\",\"element\":\"getDic_DD_type\",\"paramTypes\":[\"java.util.Map\"]},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.service.dicservice.InventoryDicService\",\"element\":\"getDic_DD_position\",\"paramTypes\":[\"java.util.Map\"]}],\"org.zen.frame.base.domain.annotation.query.Zen_Query\":[{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.inventorymanage.InventoryStatistics\",\"element\":\"commodityName\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.inventorymanage.InStore\",\"element\":\"instoreTime\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.goods.Commodity\",\"element\":\"name\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.baseinfo.AttributeInfo\",\"element\":\"name\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.inventorymanage.OutStore\",\"element\":\"outstoreTime\",\"paramTypes\":null}],\"org.zen.frame.base.domain.annotation.check.Zen_DC_Method\":[{\"classPath\":\"org.zen.modules.commonservice.dic.domain.check.DicCheck\",\"element\":\"actionAndUser_Unique\",\"paramTypes\":[\"org.zen.frame.base.domain.check.obj.CheckMethodCallObject\"]},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.check.CommodityCheck\",\"element\":\"commodity_name_unique\",\"paramTypes\":[\"org.zen.frame.base.domain.check.obj.CheckMethodCallObject\"]},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.check.AttributeInfoCheck\",\"element\":\"attributeInfo_unique\",\"paramTypes\":[\"org.zen.frame.base.domain.check.obj.CheckMethodCallObject\"]},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.check.CommodityCheck\",\"element\":\"commodity_using\",\"paramTypes\":[\"org.zen.frame.base.domain.check.obj.CheckMethodCallObject\"]},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.check.OutstoreCheck\",\"element\":\"outboundNumber\",\"paramTypes\":[\"org.zen.frame.base.domain.check.obj.CheckMethodCallObject\"]},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.check.InstoreCheck\",\"element\":\"instoreTime\",\"paramTypes\":[\"org.zen.frame.base.domain.check.obj.CheckMethodCallObject\"]},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.check.InstoreCheck\",\"element\":\"purchaserExist\",\"paramTypes\":[\"org.zen.frame.base.domain.check.obj.CheckMethodCallObject\"]},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.check.AttributeInfoItemCheck\",\"element\":\"attributeItemInfo_unique\",\"paramTypes\":[\"org.zen.frame.base.domain.check.obj.CheckMethodCallObject\"]},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.check.AttributeInfoCheck\",\"element\":\"attributeInfo_hasItems\",\"paramTypes\":[\"org.zen.frame.base.domain.check.obj.CheckMethodCallObject\"]},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.check.InstoreCheck\",\"element\":\"instoreIdExist\",\"paramTypes\":[\"org.zen.frame.base.domain.check.obj.CheckMethodCallObject\"]},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.check.AttributeInfoItemCheck\",\"element\":\"attributeItemInfo_using\",\"paramTypes\":[\"org.zen.frame.base.domain.check.obj.CheckMethodCallObject\"]},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.check.OutstoreCheck\",\"element\":\"outstoreTime\",\"paramTypes\":[\"org.zen.frame.base.domain.check.obj.CheckMethodCallObject\"]},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.check.OutstoreCheck\",\"element\":\"commodityIdExist\",\"paramTypes\":[\"org.zen.frame.base.domain.check.obj.CheckMethodCallObject\"]},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.check.InstoreCheck\",\"element\":\"commodityIdExist\",\"paramTypes\":[\"org.zen.frame.base.domain.check.obj.CheckMethodCallObject\"]}],\"org.zen.frame.base.domain.annotation.check.Zen_DC_Unique_Field\":[{\"classPath\":\"org.zen.modules.sysmngr.domain.model.po.sysrole.ZenSysRole\",\"element\":\"name\",\"paramTypes\":null}],\"org.zen.frame.base.domain.annotation.pojo.Zen_Field\":[{\"classPath\":\"org.zen.modules.commonservice.dic.domain.model.po.Dic\",\"element\":\"code\",\"paramTypes\":null},{\"classPath\":\"org.zen.modules.commonservice.dic.domain.model.po.Dic\",\"element\":\"orderNo\",\"paramTypes\":null},{\"classPath\":\"org.zen.modules.commonservice.dic.domain.model.po.Dic\",\"element\":\"value\",\"paramTypes\":null},{\"classPath\":\"org.zen.modules.commonservice.dic.domain.model.po.Dic\",\"element\":\"dicName\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.goods.CommodityFail\",\"element\":\"storeId\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.inventorymanage.Inventory\",\"element\":\"departmentId\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.baseinfo.AttributeInfoItem\",\"element\":\"attributeInfoId\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.goods.Commodity\",\"element\":\"commodityNo\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.vo.statistic.StatisticVO\",\"element\":\"commodityName\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.goods.Commodity\",\"element\":\"type\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.vo.statistic.StatisticVO\",\"element\":\"rest\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.vo.goods.CommodityFailVO\",\"element\":\"failReason\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.goods.CommodityFail\",\"element\":\"importMonitorId\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.vo.goods.CommodityVO\",\"element\":\"type\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.goods.CommodityFail\",\"element\":\"name\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.vo.goods.CommodityVO\",\"element\":\"commodityNo\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.goods.CommodityFail\",\"element\":\"position\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.inventorymanage.InStore\",\"element\":\"instorePrice\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.baseinfo.AttributeInfo\",\"element\":\"name\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.inventorymanage.InStore\",\"element\":\"instoreQuantity\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.inventorymanage.InventoryStatistics\",\"element\":\"hadUse\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.inventorymanage.OutStore\",\"element\":\"department\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.goods.CommodityFail\",\"element\":\"unit\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.goods.CommodityFail\",\"element\":\"commodityNo\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.vo.goods.CommodityVO\",\"element\":\"name\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.inventorymanage.InventoryStatistics\",\"element\":\"commodityName\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.goods.CommodityFail\",\"element\":\"type\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.vo.goods.CommodityVO\",\"element\":\"position\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.inventorymanage.Inventory\",\"element\":\"manager\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.inventorymanage.InStore\",\"element\":\"instoreTime\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.baseinfo.AttributeInfoItem\",\"element\":\"name\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.inventorymanage.OutStore\",\"element\":\"commodityId\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.vo.goods.CommodityVO\",\"element\":\"unit\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.inventorymanage.OutStore\",\"element\":\"applicant\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.inventorymanage.OutStore\",\"element\":\"storeId\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.goods.Commodity\",\"element\":\"storeId\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.inventorymanage.OutStore\",\"element\":\"outstoreTime\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.vo.statistic.StatisticVO\",\"element\":\"hadUse\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.inventorymanage.InStore\",\"element\":\"commodityId\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.goods.Commodity\",\"element\":\"unit\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.inventorymanage.InventoryStatistics\",\"element\":\"storeId\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.inventorymanage.InventoryStatistics\",\"element\":\"commodityId\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.inventorymanage.InStore\",\"element\":\"storeId\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.goods.CommodityFail\",\"element\":\"failReason\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.goods.Commodity\",\"element\":\"position\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.inventorymanage.Inventory\",\"element\":\"name\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.goods.Commodity\",\"element\":\"name\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.inventorymanage.InStore\",\"element\":\"purchaser\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.inventorymanage.OutStore\",\"element\":\"outstoreQuantity\",\"paramTypes\":null},{\"classPath\":\"com.haiyisec.oa.inventorymanager.domain.model.po.inventorymanage.InventoryStatistics\",\"element\":\"rest\",\"paramTypes\":null}]}";
    private static String scanDataStr = null;

    public static boolean dealArgs(String[] args) throws Exception {

        if (args != null && args.length >= 1) {
            if ("checkLicense".equals(args[0])) {
                Global.checkLicense = true;
                if (args.length == 1) {
                    args = null;
                } else {
                    args = Arrays.copyOfRange(args, 1, args.length);
                }
            }
        }

        if (args != null && args.length >= 1) {
            switch (args[0]) {
                case "license":
                    return LicenseWriteUtil.deal(args);
                case "securityFile":
                    return HySecurityUtil.deal(args);
                case "onlyScan":
                    LoggerContext logcontext = (LoggerContext) LoggerFactory.getILoggerFactory();
                    logcontext.getLogger("org.reflections").setLevel(Level.WARN);
                    fileScan(args);
                    return true;
                default:
                    System.out.println(ErrorConfig.运行_参数错误_Code + ":" + ErrorConfig.运行_参数错误_Msg);
                    return true;
            }
        } else {
            fileScan(args);
            return false;
        }
    }

    private static void fileScan(String[] args) {
//        log.info("文件扫描......");
        String[] packageNames = {"app", "org.zen", "com.haiyisec"};
        FileScan.scan(packageNames, scanDataStr);
    }

}
